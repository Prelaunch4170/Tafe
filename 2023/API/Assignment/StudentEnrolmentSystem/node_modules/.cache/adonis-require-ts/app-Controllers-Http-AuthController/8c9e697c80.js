"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const User_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/User"));
class AuthController {
    async login({ request, auth }) {
        const email = request.input('email');
        const password = request.input('password');
        const token = await auth.use('api').attempt(email, password, {
            expiresIn: '5 days',
        });
        return token.toJSON();
    }
    async register({ request, auth }) {
        const email = request.input('email');
        const password = request.input('password');
        const newUser = new User_1.default();
        newUser.email = email;
        newUser.password = password;
        await newUser.save();
        const token = await auth.use('api').login(newUser, {
            expiresIn: '5 days',
        });
        return token.toJSON();
    }
}
exports.default = AuthController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aENvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJBdXRoQ29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLGlGQUFrQztBQUNsQyxNQUFxQixjQUFjO0lBQ3ZCLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFzQjtRQUNwRCxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDM0MsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUMsUUFBUSxFQUFDO1lBQ3ZELFNBQVMsRUFBRSxRQUFRO1NBQ3RCLENBQUMsQ0FBQTtRQUNGLE9BQU8sS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFBO0lBQ3pCLENBQUM7SUFDTyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUMsT0FBTyxFQUFFLElBQUksRUFBc0I7UUFDdkQsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNyQyxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzNDLE1BQU0sT0FBTyxHQUFHLElBQUksY0FBSSxFQUFFLENBQUM7UUFDM0IsT0FBTyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDdEIsT0FBTyxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDNUIsTUFBTSxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUE7UUFDcEIsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUM7WUFDOUMsU0FBUyxFQUFFLFFBQVE7U0FDdEIsQ0FBQyxDQUFBO1FBQ0YsT0FBTyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDekIsQ0FBQztDQUNKO0FBckJELGlDQXFCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgSHR0cENvbnRleHRDb250cmFjdCB9IGZyb20gJ0Bpb2M6QWRvbmlzL0NvcmUvSHR0cENvbnRleHQnXHJcbmltcG9ydCBVc2VyIGZyb20gJ0FwcC9Nb2RlbHMvVXNlcidcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXV0aENvbnRyb2xsZXIge1xyXG4gICAgcHVibGljICBhc3luYyBsb2dpbih7cmVxdWVzdCwgYXV0aH06IEh0dHBDb250ZXh0Q29udHJhY3Qpe1xyXG4gICAgICAgIGNvbnN0IGVtYWlsID0gcmVxdWVzdC5pbnB1dCgnZW1haWwnKTtcclxuICAgICAgICBjb25zdCBwYXNzd29yZCA9IHJlcXVlc3QuaW5wdXQoJ3Bhc3N3b3JkJyk7XHJcbiAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBhdXRoLnVzZSgnYXBpJykuYXR0ZW1wdChlbWFpbCxwYXNzd29yZCx7XHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogJzUgZGF5cycsXHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gdG9rZW4udG9KU09OKClcclxuICAgIH1cclxuICAgIHB1YmxpYyAgYXN5bmMgcmVnaXN0ZXIoe3JlcXVlc3QsIGF1dGh9OiBIdHRwQ29udGV4dENvbnRyYWN0KXtcclxuICAgICAgICBjb25zdCBlbWFpbCA9IHJlcXVlc3QuaW5wdXQoJ2VtYWlsJyk7XHJcbiAgICAgICAgY29uc3QgcGFzc3dvcmQgPSByZXF1ZXN0LmlucHV0KCdwYXNzd29yZCcpO1xyXG4gICAgICAgIGNvbnN0IG5ld1VzZXIgPSBuZXcgVXNlcigpO1xyXG4gICAgICAgIG5ld1VzZXIuZW1haWwgPSBlbWFpbDtcclxuICAgICAgICBuZXdVc2VyLnBhc3N3b3JkID0gcGFzc3dvcmQ7XHJcbiAgICAgICAgYXdhaXQgbmV3VXNlci5zYXZlKClcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGF1dGgudXNlKCdhcGknKS5sb2dpbihuZXdVc2VyLHtcclxuICAgICAgICAgICAgZXhwaXJlc0luOiAnNSBkYXlzJyxcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0b2tlbi50b0pTT04oKVxyXG4gICAgfVxyXG59XHJcbiJdfQ==